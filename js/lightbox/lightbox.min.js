(function(){var a,j;a=jQuery;j=function(){this.fileLoadingImage="img/lightbox/loading.gif";this.fileCloseImage="img/lightbox/close.png";this.fadeDuration=this.resizeDuration=100;this.labelImage="Image";this.labelOf="of"};var d=function(a){this.options=a;this.album=[];this.currentImageIndex=void 0;this.init()};d.prototype.init=function(){this.enable();return this.build()};d.prototype.enable=function(){var b=this;return a("body").on("click","a[rel^=lightbox], area[rel^=lightbox]",function(c){b.start(a(c.currentTarget));
return!1})};d.prototype.build=function(){var b,c=this;a("<div>",{id:"lightboxOverlay"}).after(a("<div/>",{id:"lightbox"}).append(a("<div/>",{"class":"lb-outerContainer"}).append(a("<div/>",{"class":"lb-container"}).append(a("<img/>",{"class":"lb-image"}),a("<div/>",{"class":"lb-nav"}).append(a("<a/>",{"class":"lb-prev"}),a("<a/>",{"class":"lb-next"})),a("<div/>",{"class":"lb-loader"}).append(a("<a/>",{"class":"lb-cancel"}).append(a("<img/>",{src:this.options.fileLoadingImage}))))),a("<div/>",{"class":"lb-dataContainer"}).append(a("<div/>",
{"class":"lb-data"}).append(a("<div/>",{"class":"lb-details"}).append(a("<span/>",{"class":"lb-caption"}),a("<span/>",{"class":"lb-number"})),a("<div/>",{"class":"lb-closeContainer"}).append(a("<a/>",{"class":"lb-close"}).append(a("<img/>",{src:this.options.fileCloseImage}))))))).appendTo(a("body"));a("#lightboxOverlay").hide().on("click",function(){c.end();return!1});b=a("#lightbox");b.hide().on("click",function(b){"lightbox"===a(b.target).attr("id")&&c.end();return!1});b.find(".lb-outerContainer").on("click",
function(b){"lightbox"===a(b.target).attr("id")&&c.end();return!1});b.find(".lb-prev").on("click",function(){c.changeImage(c.currentImageIndex-1);return!1});b.find(".lb-next").on("click",function(){c.changeImage(c.currentImageIndex+1);return!1});b.find(".lb-loader, .lb-close").on("click",function(){c.end();return!1})};d.prototype.start=function(b){var c,k,e,d,h;a(window).on("resize",this.sizeOverlay);a("select, object, embed").css({visibility:"hidden"});a("#lightboxOverlay").width(a(document).width()).height(a(document).height()).fadeIn(this.options.fadeDuration);
this.album=[];e=0;if("lightbox"===b.attr("rel"))this.album.push({link:b.attr("href"),title:b.attr("title")});else{h=a(b.prop("tagName")+'[rel="'+b.attr("rel")+'"]');k=0;for(d=h.length;k<d;k++)c=h[k],this.album.push({link:a(c).attr("href"),title:a(c).attr("title")}),a(c).attr("href")===b.attr("href")&&(e=k)}c=a(window);b=c.scrollTop()+c.height()/10;c=c.scrollLeft();a("#lightbox").css({top:b+"px",left:c+"px"}).fadeIn(this.options.fadeDuration);this.changeImage(e)};d.prototype.changeImage=function(b){var c,
d,e,f=this;this.disableKeyboardNav();d=a("#lightbox");c=d.find(".lb-image");this.sizeOverlay();a("#lightboxOverlay").fadeIn(this.options.fadeDuration);a(".loader").fadeIn("slow");d.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide();d.find(".lb-outerContainer").addClass("animating");e=new Image;e.onload=function(){c.attr("src",f.album[b].link);c.width=e.width;c.height=e.height;return f.sizeContainer(e.width,e.height)};e.src=this.album[b].link;this.currentImageIndex=
b};d.prototype.sizeOverlay=function(){return a("#lightboxOverlay").width(a(document).width()).height(a(document).height())};d.prototype.sizeContainer=function(b,c){var d,e,f,h,j,n,g,i,l,m,o=this;e=a("#lightbox");f=e.find(".lb-outerContainer");m=f.outerWidth();l=f.outerHeight();d=e.find(".lb-container");n=parseInt(d.css("padding-top"),10);j=parseInt(d.css("padding-right"),10);h=parseInt(d.css("padding-bottom"),10);d=parseInt(d.css("padding-left"),10);i=b+d+j;g=c+n+h;i!==m&&g!==l?f.animate({width:i,
height:g},this.options.resizeDuration,"swing"):i!==m?f.animate({width:i},this.options.resizeDuration,"swing"):g!==l&&f.animate({height:g},this.options.resizeDuration,"swing");setTimeout(function(){e.find(".lb-dataContainer").width(i);e.find(".lb-prevLink").height(g);e.find(".lb-nextLink").height(g);o.showImage()},this.options.resizeDuration)};d.prototype.showImage=function(){var b;b=a("#lightbox");b.find(".lb-loader").hide();b.find(".lb-image").fadeIn("slow");this.updateNav();this.updateDetails();
this.preloadNeighboringImages();this.enableKeyboardNav()};d.prototype.updateNav=function(){var b;b=a("#lightbox");b.find(".lb-nav").show();0<this.currentImageIndex&&b.find(".lb-prev").show();this.currentImageIndex<this.album.length-1&&b.find(".lb-next").show()};d.prototype.updateDetails=function(){var b,c=this;b=a("#lightbox");"undefined"!==typeof this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&b.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast");
1<this.album.length?b.find(".lb-number").html(this.options.labelImage+" "+(this.currentImageIndex+1)+" "+this.options.labelOf+"  "+this.album.length).fadeIn("fast"):b.find(".lb-number").hide();b.find(".lb-outerContainer").removeClass("animating");b.find(".lb-dataContainer").fadeIn(this.resizeDuration,function(){return c.sizeOverlay()})};d.prototype.preloadNeighboringImages=function(){var a;this.album.length>this.currentImageIndex+1&&(a=new Image,a.src=this.album[this.currentImageIndex+1].link);0<
this.currentImageIndex&&(a=new Image,a.src=this.album[this.currentImageIndex-1].link)};d.prototype.enableKeyboardNav=function(){a(document).on("keyup.keyboard",a.proxy(this.keyboardAction,this))};d.prototype.disableKeyboardNav=function(){a(document).off(".keyboard")};d.prototype.keyboardAction=function(a){var c;c=a.keyCode;a=String.fromCharCode(c).toLowerCase();27===c||a.match(/x|o|c/)?this.end():"p"===a||37===c?0!==this.currentImageIndex&&this.changeImage(this.currentImageIndex-1):("n"===a||39===
c)&&this.currentImageIndex!==this.album.length-1&&this.changeImage(this.currentImageIndex+1)};d.prototype.end=function(){this.disableKeyboardNav();a(window).off("resize",this.sizeOverlay);a("#lightbox").fadeOut(this.options.fadeDuration);a("#lightboxOverlay").fadeOut(this.options.fadeDuration);return a("select, object, embed").css({visibility:"visible"})};a(function(){var a;a=new j;return new d(a)})}).call(this);